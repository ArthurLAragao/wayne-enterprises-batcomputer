<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wayne Enterprises | Batcomputador Grid</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* === VARI√ÅVEIS & RESET === */
    :root {
      /* Cores Base (Dark Noir Enterprise) */
      --bg-dark: #050608;
      --bg-panel: #0b0c10;
      --bg-card: #121418;
      --bg-hover: #1c1f24;
      --bg-profile: #0a0b0d;
      
      --border: rgba(255, 255, 255, 0.08);
      
      /* Cores de Status */
      --success: #00C853; /* Verde T√°tico */
      --warning: #FFAB00; /* √Çmbar Alerta */
      --danger: #FF3D00;  /* Vermelho Cr√≠tico */
      --info: #2979FF;    /* Azul Sistema */
      --reserved: #00BFFF; /* Ciano Reservado */
      
      /* Texto */
      --text-main: #E0E0E0;
      --text-muted: #889096;
      --text-dim: #4A5055;
      
      /* Identidade Wayne Padr√£o */
      --wayne-gold: #FFC107;
      --wayne-cyan: #00BFFF;
      
      /* Din√¢micos (Seta no Login) */
      --accent: var(--wayne-gold);
      --grid-color: rgba(255, 215, 10, 0.03);

      /* Fontes */
      --font-ui: 'Rajdhani', sans-serif;
      --font-code: 'Fira Code', monospace;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
    
    body {
      background-color: var(--bg-dark);
      color: var(--text-main);
      font-family: var(--font-ui);
      height: 100vh;
      overflow: hidden;
      position: relative;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #000; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #444; }

    /* === BACKGROUND & PATTERNS === */
    .bg-grid {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background-image: 
        linear-gradient(var(--grid-color) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
      background-size: 40px 40px;
      z-index: -2; pointer-events: none;
    }
    .bg-watermark {
      position: fixed; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      font-size: 35vw; font-weight: 800;
      color: rgba(255, 255, 255, 0.015);
      z-index: -1; user-select: none; pointer-events: none; font-family: serif;
    }

    /* === UTILS (ICONS & TYPO) === */
    .icon { width: 18px; height: 18px; stroke: currentColor; stroke-width: 2; fill: none; stroke-linecap: round; stroke-linejoin: round;}
    .icon-sm { width: 14px; height: 14px; }
    .text-mono { font-family: var(--font-code); }
    .flex-row { display: flex; align-items: center; gap: 8px; }
    
    /* === LOADER (TERMINAL) === */
     .loader-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #000; z-index: 9999;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      font-family: var(--font-code);
      transition: opacity 0.8s ease;
    }
    .terminal-box {
      width: 600px; max-width: 90%; color: var(--accent); font-size: 0.9rem;
    }
    .terminal-line { margin-bottom: 5px; opacity: 0; animation: typeLine 0.1s forwards; border-right: 2px solid transparent;}
    .terminal-line.typing { border-right: 2px solid var(--accent); }
    @keyframes typeLine { to { opacity: 1; } }

    /* === LOGIN SCREEN === */
    .login-wrapper {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      display: none; flex-direction: column; align-items: center; justify-content: center;
      z-index: 100; transition: opacity 0.5s ease;
      background: radial-gradient(circle at center, #111 0%, #000 100%);
    }
    .btn-primary {
      width: 100%; padding: 12px; background: var(--wayne-gold); color: #000;
      font-weight: 700; text-transform: uppercase; letter-spacing: 1px; font-size: 0.8rem;
      border: none; cursor: pointer; transition: all 0.2s; margin-top: 10px;
    }
    .btn-primary:hover { background: #e6a700; box-shadow: 0 0 10px rgba(255, 193, 7, 0.3); }

    /* === LOGIN CARD COMPACTO E CENTRALIZADO === */
    .login-card {
      width: 100%; max-width: 320px; background: var(--bg-panel); border: 1px solid rgba(255, 215, 10, 0.1); border-radius: 8px;
      padding: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.8); backdrop-filter: blur(8px); text-align: center;
      animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }
    .login-header {
      margin-bottom: 24px;
    }
    .login-title {
      font-size: 1.2rem; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; color: var(--wayne-gold);
    }
    .system-status {
      margin-top: 8px; font-size: 0.7rem; color: var(--wayne-cyan); text-transform: uppercase; letter-spacing: 1px;
    }
    .input-group {
      margin-bottom: 16px; text-align: left;
    }
    .input-group label {
      font-size: 0.7rem; color: var(--text-muted); margin-bottom: 4px; display: block; text-transform: uppercase; letter-spacing: 1px;
    }
    .input-field {
      width: 100%; padding: 10px; background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); color: #fff;
      font-size: 0.9rem; transition: all 0.2s; border-radius: 4px;
    }
    .input-field:focus {
      border-color: var(--wayne-gold); box-shadow: 0 0 8px rgba(255, 193, 7, 0.2);
    }
    #loginError {
      margin-top: 8px; font-size: 0.7rem; color: var(--danger); animation: blink 1s infinite;
    }
    @keyframes blink { 50% { opacity: 0.5; } }
    .restricted-note {
      margin-top: 16px; font-size: 0.6rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;
    }

    /* LOADER SEGMENTADO */
    .spinner {
      display: none; width: 24px; height: 24px; border: 3px solid rgba(255, 215, 10, 0.3); border-top: 3px solid var(--wayne-gold);
      border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* === APP LAYOUT === */
    .app-container {
      display: none; height: 100vh;
      grid-template-rows: 64px 1fr 28px;
      grid-template-columns: 260px 1fr;
      grid-template-areas: "header header" "sidebar main" "footer footer";
    }

    /* HEADER */
    .app-header {
      grid-area: header; background: rgba(8, 9, 12, 0.9); backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between; padding: 0 24px;
      z-index: 50; position: sticky; top: 0;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .brand-logo { width: 36px; height: 36px; background: var(--accent); color: #000; display: grid; place-items: center; font-weight: 900; border-radius: 4px; font-size: 1.2rem;}
    .brand-info h1 { font-size: 0.95rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; line-height: 1.2; }
    .brand-info p { font-size: 0.65rem; color: var(--text-muted); letter-spacing: 0.5px; white-space: nowrap; }
    
    .header-controls { display: flex; align-items: center; gap: 20px; }
    .sys-clock { font-family: var(--font-code); font-size: 0.8rem; color: var(--text-main); }
    .action-btn {
      padding: 6px 12px; font-size: 0.75rem; border: 1px solid var(--border); background: rgba(0,0,0,0.3);
      color: var(--text-main); border-radius: 4px; cursor: pointer; transition: all 0.2s;
    }
    .action-btn.danger-btn { border-color: var(--danger); color: var(--danger); }
    .action-btn:hover { border-color: var(--accent); color: var(--accent); }
    .action-btn:active { transform: scale(0.98); }

    /* SIDEBAR */
    .app-sidebar {
      grid-area: sidebar; background: var(--bg-panel); border-right: 1px solid var(--border);
      display: flex; flex-direction: column; overflow-y: auto;
    }
    .user-profile-card {
      padding: 20px; background: var(--bg-profile); border-bottom: 1px solid var(--border);
      display: flex; flex-direction: column; align-items: center; text-align: center;
      margin-bottom: 20px;
    }
    .user-avatar {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: #111;
      border: 2px solid var(--accent);
      /* remove cor de fonte para evitar texto grande quando img faltar */
      color: transparent;
      display: grid;
      place-items: center;
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 12px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.4);

      /* ESSENCIAL: recorta o conte√∫do (imagem) ao formato circular */
      overflow: hidden;
    }

    /* garante que a imagem preencha o c√≠rculo sem distorcer */
    .user-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;   /* preenche e corta sem distorcer */
      display: block;
    }

    .user-details h3 { font-size: 1rem; color: #fff; font-weight: 600; margin-bottom: 4px; }
    .user-details span { 
      font-size: 0.65rem; text-transform: uppercase; letter-spacing: 1px; 
      color: var(--bg-dark); background: var(--accent); padding: 2px 6px; border-radius: 2px; font-weight: 700;
    }

    .nav-menu { flex: 1; padding: 0 12px 24px; display: flex; flex-direction: column; gap: 4px; }
    .nav-btn {
      display: flex; align-items: center; gap: 12px; width: 100%;
      padding: 12px 16px; color: var(--text-muted); background: transparent; border: none;
      font-size: 0.85rem; font-weight: 500; cursor: pointer; border-radius: 6px; transition: all 0.2s;
      text-align: left;
    }
    .nav-btn:hover { color: #fff; background: var(--bg-hover); }
    .nav-btn.active { background: rgba(255, 255, 255, 0.05); color: var(--accent); border-left: 3px solid var(--accent); border-radius: 0 6px 6px 0; }

    /* FOOTER */
    .app-footer {
      grid-area: footer; background: var(--bg-panel); border-top: 1px solid var(--border);
      display: flex; align-items: center; justify-content: center; gap: 15px;
      font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px;
    }
    .app-footer span:not(:last-child)::after { content: ' | '; color: var(--text-dim); margin-left: 15px; }
    .app-footer a { color: var(--text-muted); text-decoration: none; font-weight: 500; }

    /* MAIN CONTENT */
    .app-main { grid-area: main; padding: 32px 40px; overflow-y: auto; background: transparent; }
    
    .page-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 20px; }
    .page-title h2 { font-size: 1.5rem; font-weight: 400; text-transform: uppercase; letter-spacing: 1px; color: #fff; }
    .page-title span { color: var(--accent); font-weight: 700; }

    /* GRID & CARDS */
    .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .metric-card { background: var(--bg-card); border: 1px solid var(--border); padding: 20px; border-radius: 6px; position: relative; display: flex; flex-direction: column; gap: 10px; }
    .metric-val { font-size: 1.8rem; font-weight: 700; color: #fff; font-family: var(--font-code); }
    
    /* AREA CARDS */
    .area-filters { display: flex; gap: 10px; margin-bottom: 20px; }
    .filter-chip {
      padding: 6px 14px; background: var(--bg-card); border: 1px solid var(--border); color: var(--text-muted);
      border-radius: 20px; font-size: 0.75rem; cursor: pointer; transition: all 0.2s; white-space: nowrap;
    }
    .filter-chip:hover, .filter-chip.active { border-color: var(--accent); color: var(--accent); background: rgba(255,255,255,0.05); box-shadow: 0 0 8px var(--accent); }

    .areas-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 24px; }
    .area-card {
      background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; overflow: hidden;
      transition: all 0.2s; display: flex; flex-direction: column;
    }
    .area-card:hover { transform: translateY(-3px); border-color: var(--accent); box-shadow: 0 5px 20px rgba(0,0,0,0.3); }
    .area-card.filtered-out { opacity: 0.4; filter: grayscale(100%); pointer-events: none; }
    
    .area-header-card {
      padding: 16px; background: rgba(255,255,255,0.02); border-bottom: 1px solid var(--border);
      display: flex; justify-content: space-between; align-items: center;
    }
    .area-title-card { font-weight: 700; font-size: 1rem; color: #fff; display: flex; align-items: center; gap: 10px; }
    .area-body-card { padding: 16px; flex: 1; }
    
    .level-indicator { margin: 12px 0; }
    .level-label { font-size: 0.7rem; color: var(--text-muted); display: flex; justify-content: space-between; margin-bottom: 4px; }
    .level-bar { height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; display: flex; gap: 2px; }
    .lvl-seg { flex: 1; background: #333; }
    .lvl-seg.filled { background: var(--accent); }

    .area-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 10px; }
    .tag { font-size: 0.65rem; padding: 2px 6px; background: rgba(255,255,255,0.05); color: var(--text-muted); border-radius: 3px; border: 1px solid rgba(255,255,255,0.05); }
    
    .risk-label {
        font-size: 0.7rem; font-weight: 600; padding: 4px 8px; border-radius: 4px; display: inline-flex; align-items: center; gap: 5px; text-transform: uppercase;
        margin-top: 10px;
    }
    .risk-low { color: var(--success); background: rgba(0,200,83,0.15); border: 1px solid rgba(0,200,83,0.3); }
    .risk-medium { color: var(--warning); background: rgba(255,171,0,0.15); border: 1px solid rgba(255,171,0,0.3); }
    .risk-high { color: var(--danger); background: rgba(255,61,0,0.15); border: 1px solid rgba(255,61,0,0.3); }
    .risk-extreme { color: var(--danger); background: rgba(255,61,0,0.3); border: 1px solid var(--danger); }

    .area-footer-card {
      padding: 12px 16px; border-top: 1px solid var(--border);
      display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.2);
    }
    .details-btn { font-size: 0.75rem; font-weight: 600; color: var(--accent); background: none; border: none; cursor: pointer; display: flex; align-items: center; gap: 4px; text-transform: uppercase; transition: all 0.2s; }
    .details-btn:hover { text-decoration: underline; color: #fff; }

    .status-badge {
      display: inline-flex; align-items: center; gap: 6px; font-size: 0.7rem; font-weight: 700;
      padding: 4px 8px; border-radius: 4px; text-transform: uppercase;
    }
    .status-badge.ok { background: var(--success); color: var(--bg-dark); }
    .status-badge.nominal { background: var(--info); color: var(--bg-dark); }
    .status-badge.attention { background: var(--warning); color: var(--bg-dark); animation: pulse 1.5s infinite; }
    .status-badge.critical { background: var(--danger); color: #fff; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255,61,0,0.7); } 70% { box-shadow: 0 0 0 10px rgba(255,61,0,0); } 100% { box-shadow: 0 0 0 0 rgba(255,61,0,0); } }

    /* MODAL */
    .modal-backdrop {
      position: fixed; top:0; left:0; width:100%; height:100%;
      background: rgba(0,0,0,0.85); backdrop-filter: blur(4px);
      z-index: 1000; display: none; place-items: center; overflow-y: auto;
    }
    .modal-panel {
      background: var(--bg-card); border: 1px solid var(--accent);
      width: 90%; max-width: 800px; margin: 50px 0;
      padding: 30px; box-shadow: 0 0 40px rgba(0,0,0,0.8);
      position: relative; animation: fadeInZoom 0.3s ease;
    }
    @keyframes fadeInZoom { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

    /* USER PROFILE PAGE */
    .profile-grid { display: grid; grid-template-columns: 300px 1fr; gap: 30px; }
    .profile-info-card { background: var(--bg-card); padding: 20px; border: 1px solid var(--border); border-radius: 6px; }
    .profile-detail-list { margin-top: 15px; }
    .profile-detail-list div { padding: 8px 0; border-bottom: 1px dotted rgba(255,255,255,0.05); font-size: 0.85rem; }
    .profile-detail-list strong { color: var(--text-main); font-weight: 600; display: inline-block; width: 120px; }

    /* ANIMATIONS */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* Table for inventory */
    .data-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
    .data-table th { background: var(--bg-hover); text-align: left; padding: 12px; text-transform: uppercase; font-size: 0.7rem; color: var(--text-muted); border-bottom: 1px solid var(--border); }
    .data-table td { padding: 12px; border-bottom: 1px solid var(--border); }
    .data-table tr:hover { background: var(--bg-hover); }

    /* Invent√°rio visual terminal */
    #inventorySection { background: var(--bg-panel); color: var(--text-muted); padding: 20px; border: 1px solid var(--border); border-radius: 6px; }
    #inventorySection .page-title h2 { color: var(--wayne-cyan); }

    /* Tabela responsiva */
    .inventory-grid { display: none; } /* Default table */
    @media (max-width: 768px) {
      .data-table { display: none; }
      .inventory-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
      .inventory-card { background: var(--bg-card); padding: 15px; border: 1px solid var(--border); border-radius: 6px; text-align: center; }
      .inventory-card .quantity { font-size: 2rem; color: var(--accent); }
      .inventory-card .location { background: rgba(0,191,255,0.1); color: var(--wayne-cyan); padding: 4px 8px; border-radius: 4px; font-size: 0.7rem; }
    }

    /* Filtros horizontais */
    .inventory-filters { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; }

    /* Campo de busca */
    .search-container { margin-bottom: 20px; position: relative; }
    .search-input { width: 100%; padding: 10px 40px 10px 10px; background: rgba(0,0,0,0.5); border: 1px solid var(--border); color: #fff; border-radius: 4px; transition: all 0.2s; }
    .search-input:focus { border-color: var(--wayne-cyan); animation: typeFocus 0.5s; }
    .search-icon { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); }
    @keyframes typeFocus { 0% { box-shadow: 0 0 5px var(--wayne-cyan); } 100% { box-shadow: 0 0 15px var(--wayne-cyan); } }

    /* P√≠lulas de status */
    .status-pill { padding: 4px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold; position: relative; }
    .status-pill.normal { background: rgba(0,200,83,0.2); color: var(--success); }
    .status-pill.attention { background: rgba(255,171,0,0.2); color: var(--warning); animation: shake 2s infinite; }
    .status-pill.critical { background: rgba(255,61,0,0.2); color: var(--danger); animation: pulse 1s infinite; }
    .status-pill.reserved { background: rgba(0,191,255,0.2); color: var(--reserved); }
    .status-pill::after { content: attr(data-tooltip); position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); background: var(--bg-hover); padding: 5px; border-radius: 4px; font-size: 0.6rem; white-space: nowrap; opacity: 0; transition: opacity 0.2s; pointer-events: none; }
    .status-pill:hover::after { opacity: 1; }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50% { transform: translateX(-2px); } 20%, 40% { transform: translateX(2px); } }

    /* Drawer lateral */
    .drawer { position: fixed; top: 0; right: -400px; width: 400px; height: 100%; background: var(--bg-panel); border-left: 1px solid var(--border); z-index: 999; transition: right 0.3s ease; padding: 20px; overflow-y: auto; }
    .drawer.open { right: 0; }
    .drawer-close { position: absolute; top: 10px; right: 10px; background: none; border: none; color: var(--text-muted); cursor: pointer; }
    .timeline { list-style: none; padding: 0; }
    .timeline li { padding: 10px 0; border-bottom: 1px solid var(--border); position: relative; }
    .timeline li::before { content: ''; position: absolute; left: -10px; top: 15px; width: 5px; height: 5px; background: var(--accent); border-radius: 50%; }
    .sparkline { height: 50px; background: rgba(0,0,0,0.5); position: relative; }
    .sparkline::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 2px; background: linear-gradient(to right, var(--success), var(--warning), var(--danger)); }
    .priority { font-size: 0.8rem; color: var(--accent); }

    /* Microanima√ß√µes */
    .drawer.open { animation: drawLine 0.5s; }
    @keyframes drawLine { from { border-left-width: 0; } to { border-left-width: 1px; } }
    .quantity-animate { animation: countUp 1s; }
    @keyframes countUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .drawer::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,0.02) 2px, rgba(255,255,255,0.02) 4px); opacity: 0.5; pointer-events: none; animation: scan 2s linear infinite; }
    @keyframes scan { from { background-position: 0 0; } to { background-position: 0 4px; } }

    /* Bot√£o repor estoque */
    .replenish-btn { padding: 8px 16px; background: var(--wayne-gold); color: #000; border: none; cursor: pointer; margin-top: 20px; transition: all 0.2s; }
    .replenish-btn:hover { box-shadow: 0 0 10px var(--wayne-gold); }
    .replenish-msg {
    display: none;
    color: var(--wayne-cyan);
    font-family: var(--font-code);
    animation: typeMsg 2s steps(40, end);
    overflow: hidden;
    white-space: nowrap;
    width: 0;
  } 

    @keyframes typeMsg {
    from { width: 0; }
    to { width: 100%; }
      }


    /* Itens sens√≠veis */
    .sensitive { position: relative; }
    .sensitive::after { content: 'ü¶á N√≠vel Batman'; opacity: 0.3; position: absolute; top: 5px; right: 5px; font-size: 0.8rem; color: var(--accent); }

    /* Dashboard principal */
    .dashboard-layout { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: auto 1fr 1fr; gap: 20px; height: calc(100vh - 92px); overflow: hidden; }
    .dashboard-top-left { grid-column: 1; grid-row: 1; }
    .dashboard-top-right { grid-column: 2; grid-row: 1; }
    .dashboard-middle-left { grid-column: 1; grid-row: 2; }
    .dashboard-middle-right { grid-column: 2; grid-row: 2; }
    .dashboard-bottom-left { grid-column: 1; grid-row: 3; }
    .dashboard-bottom-right { grid-column: 2; grid-row: 3; }
    .system-bar { display: flex; justify-content: space-around; background: var(--bg-hover); padding: 10px; border-bottom: 1px solid var(--border); }
    .system-indicator { font-size: 0.7rem; padding: 5px 10px; border-radius: 4px; display: flex; align-items: center; gap: 5px; transition: all 0.2s; }
    .system-indicator:hover { box-shadow: 0 0 5px currentColor; }
    .system-indicator.safe { background: var(--success); color: var(--bg-dark); }
    .system-indicator.alert { background: var(--warning); color: var(--bg-dark); animation: pulse 1.5s infinite; }
    .system-indicator.critical { background: var(--danger); color: #fff; animation: pulse 1.5s infinite; }

 /* Mini-mapa */
.mini-map {
  height: 100%;
  background: #000 url('gothammap2.jpg') center/cover no-repeat;
  position: relative;
  border: 1px solid var(--border);
}

.map-point {
  position: absolute;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--success);
  box-shadow: 0 0 10px var(--success);
  cursor: pointer;
  transition: transform 0.2s;
}

.map-point:hover {
  transform: scale(1.5);
}

/* Tooltip pequeno (continua funcionando) */
.map-point::after {
  content: attr(data-tooltip);
  position: absolute;
  top: -22px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-hover);
  padding: 3px 6px;
  font-size: 0.6rem;
  opacity: 0;
  white-space: nowrap;
  pointer-events: none;
  transition: opacity 0.2s;
}

.map-point:hover::after {
  opacity: 1;
}

/* MINI CARD AGORA FUNCIONA APENAS NO HOVER */
.map-mini-card {
  position: absolute;
  top: 140%;
  left: 50%;
  transform: translateX(-50%) translateY(10px);
  background: rgba(0,0,0,0.9);
  padding: 10px 12px;
  border-radius: 6px;
  border: 1px solid var(--wayne-cyan);
  font-size: 0.7rem;
  white-space: nowrap;
  box-shadow: 0 0 10px rgba(0, 234, 255, 0.4);

  /* ESCONDIDO POR PADR√ÉO */
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease, transform 0.25s ease;
}

/* APARECE S√ì NO HOVER */
.map-point:hover .map-mini-card {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
  pointer-events: auto;
}
    /* Widget resumo invent√°rio */
    .inventory-summary { background: var(--bg-card); padding: 15px; border: 1px solid var(--border); }
    .summary-count { font-size: 2rem; color: var(--accent); animation: countUp 1s; }
    .bar-chart { display: flex; gap: 5px; height: 50px; align-items: flex-end; }
    .bar { background: var(--accent); width: 20px; animation: growBar 1s; }
    @keyframes growBar { from { height: 0; } }

    /* Alertas recentes */
    .alerts-panel { background: var(--bg-card); padding: 15px; border: 1px solid var(--border); overflow-y: auto; height: 100%; }
    .alert-item { padding: 10px; border-bottom: 1px solid var(--border); animation: slideUp 0.5s; font-size: 0.8rem; }
    .alert-item.filtered-out { display: none; }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .alert-filters { display: flex; gap: 10px; margin-bottom: 10px; }

    /* Miss√µes ativas */
    .missions-panel { background: var(--bg-card); padding: 15px; border: 1px solid var(--border); display: flex; flex-direction: column; gap: 10px; height: 100%; overflow-y: auto; }
    .mission-card { padding: 10px; border: 1px solid var(--border); border-radius: 4px; transition: all 0.2s; }
    .mission-card:hover { border-color: var(--wayne-cyan); box-shadow: 0 0 10px var(--wayne-cyan); }
    .progress-bar { height: 5px; background: rgba(255,255,255,0.1); border-radius: 3px; }
    .progress-fill { height: 100%; background: var(--accent); transition: width 0.5s; }

    /* Logs do sistema */
    .logs-panel { background: var(--bg-card); padding: 15px; border: 1px solid var(--border); height: 100%; overflow-y: scroll; font-family: var(--font-code); font-size: 0.75rem; color: var(--wayne-cyan); }
    .logs-panel.paused { overflow-y: hidden; }
    .log-item { margin-bottom: 5px; animation: fadeIn 0.3s; }
    .log-controls { display: flex; gap: 10px; margin-bottom: 10px; }

    /* Perfil r√°pido */
    .quick-profile { display: flex; align-items: center; gap: 10px; }
    .profile-avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--accent); color: #000; display: grid; place-items: center; font-weight: bold; }
    .profile-actions { display: flex; gap: 10px; }

    /* Painel de pessoal com refer√™ncias Batman */
    .users-panel { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
    .user-card { background: var(--bg-card); padding: 20px; border: 1px solid var(--border); border-radius: 6px; position: relative; box-shadow: 0 2px 10px rgba(0,0,0,0.3); transition: all 0.2s; }
    .user-card:hover { box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
    .user-card .avatar { width: 80px; height: 80px; border-radius: 50%; background-size: cover; background-position: center; border: 2px solid var(--border); margin-bottom: 15px; object-fit: cover; aspect-ratio: 1/1; }
    .user-card .codiname { position: absolute; top: 15px; right: 15px; background: var(--accent); color: var(--bg-dark); padding: 4px 8px; border-radius: 4px; font-size: 0.7rem; text-transform: uppercase; }
    .user-card .desc { font-size: 0.9rem; color: var(--text-muted); }
    .easter-egg { color: var(--danger); font-style: italic; font-size: 0.7rem; }

    /* Responsivo para users-panel */
    @media (max-width: 1200px) {
      .users-panel { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      .app-container { grid-template-columns: 1fr; grid-template-areas: "header" "main" "sidebar" "footer"; }
      .app-sidebar { order: 3; }
      .dashboard-layout { grid-template-columns: 1fr; grid-template-rows: auto auto auto auto auto auto; }
      .drawer { width: 100%; right: -100%; }
      .users-panel { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <div class="bg-grid"></div>
  <div class="bg-watermark">W</div>

  <div class="loader-screen" id="loader">
    <div class="terminal-box" id="terminalOutput"></div>
  </div>

  <div class="login-wrapper" id="loginScreen">
    <div class="login-card">
      <div class="login-header">
        <div class="login-title">WAYNE ENTERPRISES | BATCOMPUTADOR GRID</div>
        <div class="system-status">GRID STATUS: ARMED | NODES ONLINE: 12</div>
      </div>
      
      <form onsubmit="handleLogin(event)">
        <div class="input-group">
          <label>USER ID</label>
          <input type="text" id="username" class="input-field" placeholder="ID de Usu√°rio" autocomplete="off" required>
        </div>
        
        <div class="input-group">
          <label>ACCESS KEY</label>
          <input type="password" id="password" class="input-field" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
        </div>

        <button type="submit" class="btn-primary" id="loginBtn">LOGIN <span class="spinner" id="spinner"></span></button>
      </form>
      <div id="loginError"></div>
      <div class="restricted-note">
        ACESSO RESTRITO A PESSOAL AUTORIZADO.<br>TENTATIVAS MONITORADAS.
      </div>
    </div>
  </div>

  <div class="app-container" id="app">
    <header class="app-header">
      <div class="brand">
        <div class="brand-logo">W</div>
        <div class="brand-info">
          <h1>WAYNE ENTERPRISES</h1>
          <p>BATCOMPUTADOR GRID | MONITORAMENTO AVAN√áADO</p>
        </div>
      </div>
    <div class="header-controls">
      <span class="sys-clock text-mono" id="headerClock">--/--/-- --:--:--</span>
      <div class="quick-profile">
      <div class="profile-avatar" id="userAvatar">
      <img id="userAvatarImg" src="" alt="Avatar do usu√°rio">
          </div>
        <div>

            <h4 id="userName">Bruce Wayne</h4>
            <p id="userLevel">N√çVEL 5</p>
          </div>
          <div class="profile-actions">
            <button class="action-btn" onclick="activateContainment()">Modo de Conten√ß√£o</button>
            <button class="action-btn" onclick="lockFacilities()">Bloquear Instala√ß√µes</button>
            <button class="action-btn" onclick="nav('resources')">Vis√£o de Invent√°rio</button>
          </div>
        </div>
        <button class="action-btn danger-btn" onclick="logout()">SAIR</button>
      </div>
    </header>

    <aside class="app-sidebar">
      <nav class="nav-menu">
        <button class="nav-btn active" onclick="nav('dashboard')" id="nav-dashboard">
          <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
          Dashboard
        </button>
        <button class="nav-btn" onclick="nav('areas')" id="nav-areas">
          <svg class="icon" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
          √Åreas de Risco
        </button>
        <button class="nav-btn" onclick="nav('resources')" id="nav-resources">
          <svg class="icon" viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
          Invent√°rio
        </button>
        <button class="nav-btn" onclick="nav('users')" id="nav-users">
           <svg class="icon" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
          Pessoal (Perfis)
        </button>
        <button class="nav-btn" onclick="nav('audit')" id="nav-audit">
          <svg class="icon" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
          Auditoria
        </button>
      </nav>
    </aside>

    <main class="app-main" id="mainContent">
      </main>

    <footer class="app-footer">
      <span>¬© 2025 WAYNE ENTERPRISES</span>
      <a href="#">TERMOS DE USO</a>
      <a href="#">POL√çTICA DE SEGURAN√áA</a>
      <span>SISTEMA MONITORADO</span>
    </footer>
  </div>

  <div class="modal-backdrop" id="modal">
    <div class="modal-panel">
      <button onclick="closeModal()" style="position:absolute; top:20px; right:20px; background:none; border:none; color:var(--text-muted); cursor:pointer;">
        <svg class="icon" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
      </button>
      <div id="modalContent"></div>
    </div>
  </div>

  <div class="drawer" id="itemDrawer">
    <button class="drawer-close" onclick="closeDrawer()">
      <svg class="icon" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
    <div id="drawerContent"></div>
  </div>

  <script>
    /* === CONFIGURA√á√ÉO E DADOS === */
    const USER_PROFILES = {
      bruce: {
        id: 'bruce', name: 'Bruce Wayne', role: 'CEO / Batman', pass: 'batman', theme: '#FFC107', level: 5, short:'B', codiname: 'BATMAN',
        desc: 'Administrador-Chefe de Seguran√ßa. Possui acesso total (N√≠vel 5) ao Batcomputador e a todos os recursos da Wayne Enterprises. Respons√°vel final por todos os protocolos de seguran√ßa e opera√ß√µes de campo. (Easter egg: Guardi√£o da Noite de Gotham, com capa e capuz sempre prontos.)',
        security: ['Biometria Wayne', 'Senha T√°tica', 'Cofre Pessoal: Ativo'],
        responsibilities: ['Gest√£o de Opera√ß√µes de Campo', 'Aprova√ß√£o de Or√ßamentos de P&D', 'Supervis√£o de Seguran√ßa N√≠vel 5'],
        history: 'Registro de atividades confidenciais. Acesso ao log de auditoria irrestrito. (Easter egg: Sobrevivente de incont√°veis noites em Arkham.)',
        photo: 'batman.jpg',
        function: 'Lideran√ßa estrat√©gica e opera√ß√µes noturnas',
        specialty: 'Combate avan√ßado, detetive, tecnologia',
        weakness: 'Trauma psicol√≥gico, isolamento',
        relationships: 'Alfred (confian√ßa total), Dick (filho adotivo), Damian (filho biol√≥gico)',
        observations: 'Protocolo Knightfall ativo em caso de falha'
      },
      alfred: {
        id: 'alfred', name: 'Alfred Pennyworth', role: 'Operations Manager', pass: 'butler', theme: '#9E9E9E', level: 4, short:'A', codiname: 'BUTLER',
        desc: 'Gerente de Opera√ß√µes e suporte de campo. Acesso a todos os sistemas de monitoramento e controle de invent√°rio. N√≠vel 4 permite controle de recursos, mas n√£o auditoria completa. (Easter egg: O mordomo que sabe mais segredos do que o pr√≥prio Batman.)',
        security: ['ID T√°tico', 'Comando de Voz', 'Protocolo de Emerg√™ncia 4.0'],
        responsibilities: ['Log√≠stica e Suporte Remoto', 'Gest√£o de Invent√°rio de Recursos', 'Monitoramento Prim√°rio de √Åreas'],
        history: 'Manuten√ß√£o de registros, coordena√ß√£o de miss√µes. (Easter egg: Ch√° sempre pronto para ap√≥s as patrulhas.)',
        photo: 'alfred.jpg',
        function: 'Suporte log√≠stico e m√©dico',
        specialty: 'Medicina de campo, log√≠stica, conselhos',
        weakness: 'Idade avan√ßada',
        relationships: 'Bruce (como pai), Fam√≠lia Wayne (lealdade absoluta)',
        observations: 'FOX Secure Node integrado'
      },
      dick: {
        id: 'dick', name: 'Dick Grayson', role: 'Field Agent / Nightwing', pass: 'noturno', theme: '#2979FF', level: 3, short:'N', codiname: 'NIGHTWING',
        desc: 'Agente de campo ativo (N√≠vel 3). Acesso a informa√ß√µes de √°reas de risco e invent√°rio para aloca√ß√£o de recursos. Acesso restrito a dados confidenciais de pessoal e auditoria. (Easter egg: O primeiro Robin, agora voando solo em Bl√ºdhaven.)',
        security: ['ID T√°tico', 'Acesso M√≥vel Criptografado'],
        responsibilities: ['Reconhecimento de Campo', 'An√°lise T√°tica de √Årea', 'Uso de Recursos T√°ticos'],
        history: 'Registros de miss√µes. Acesso apenas ao seu pr√≥prio log de auditoria.',
        photo: 'Nightwing.jpg',
        function: 'Opera√ß√µes de infiltra√ß√£o',
        specialty: 'Acrobacia, lideran√ßa em equipe',
        weakness: 'Impulsividade',
        relationships: 'Bruce (mentor), Barbara (parceira)',
        observations: 'Bl√ºdhaven link stable'
      },
      damian: {
        id: 'damian', name: 'Damian Wayne', role: 'Field Agent / Robin', pass: 'robin', theme: '#00C853', level: 3, short:'R', codiname: 'ROBIN',
        desc: 'Agente de campo j√∫nior com o mesmo n√≠vel de acesso do Dick (N√≠vel 3). Foco em opera√ß√µes furtivas e uso de equipamentos de vigil√¢ncia e drones. (Easter egg: Filho do Batman, treinado pela Liga dos Assassinos.)',
        security: ['ID T√°tico', 'Protocolo Silencioso'],
        responsibilities: ['Vigil√¢ncia e Infiltra√ß√£o', 'Uso e Manuten√ß√£o de Drones', 'Coleta de Informa√ß√µes de Campo'],
        history: 'Registros de miss√µes recentes.',
        photo: 'damian.jpg',
        function: 'Vigil√¢ncia e combate',
        specialty: 'Artes marciais, stealth',
        weakness: 'Arrog√¢ncia juvenil',
        relationships: 'Bruce (pai), Dick (irm√£o)',
        observations: 'Caso 027 - Monitorar'
      },
      barbara: {
        id: 'barbara', name: 'Barbara Gordon', role: 'Oracle / Systems Analyst', pass: 'oracle', theme: '#AA00FF', level: 2, short:'O', codiname: 'ORACLE',
        desc: 'Analista de Sistemas (N√≠vel 2). Acesso apenas a Dashboard e Monitoramento de √Åreas para an√°lise em tempo real. N√£o possui controle de recursos nem acesso a dados de pessoal/auditoria. (Easter egg: A mente por tr√°s da rede, mesmo ap√≥s o Coringa.)',
        security: ['Acesso Remoto Seguro', 'Criptografia ORACLE'],
        responsibilities: ['An√°lise de Dados em Tempo Real', 'Monitoramento de Redes de Comunica√ß√£o', 'Relat√≥rios de Risco'],
        history: 'Sem acesso a logs de auditoria de n√≠vel 5.',
        photo: 'barbara.jpg',
        function: 'An√°lise de dados e suporte remoto',
        specialty: 'Hacking, intelig√™ncia',
        weakness: 'Mobilidade limitada',
        relationships: 'Dick (parceiro), Bruce (aliado)',
        observations: 'Oracle Link Stable'
      },
      lucius: {
        id: 'lucius', name: 'Lucius Fox', role: 'Head of R&D / CTO', pass: 'tech', theme: '#FF6D00', level: 1, short:'L', codiname: 'FOX',
        desc: 'Chefe de P&D (N√≠vel 1). Acesso apenas ao Dashboard e m√©tricas gerais. Seu foco √© no desenvolvimento de tecnologia; o controle de seguran√ßa √© delegado ao Bruce. (Easter egg: Inventor do arsenal que mant√©m o Batman vivo.)',
        security: ['Senha Padr√£o', 'Acesso Restrito a Lab.'],
        responsibilities: ['Desenvolvimento de Tecnologia T√°tica', 'Gest√£o de Or√ßamento de P&D'],
        history: 'Acesso apenas a projetos de P&D. (Easter egg: "Eu n√£o pergunto o que voc√™ faz com isso, Sr. Wayne.")',
        photo: 'lucius.jpg',
        function: 'Desenvolvimento tecnol√≥gico',
        specialty: 'Engenharia, inven√ß√µes',
        weakness: 'Exposi√ß√£o corporativa',
        relationships: 'Bruce (parceiro de neg√≥cios)',
        observations: 'Projeto OMAC em an√°lise'
      },
      tim: {
        id: 'tim', name: 'Tim Drake', role: 'Field Agent / Red Robin', pass: 'redrobin', theme: '#1B5E20', level: 3, short:'RR', codiname: 'RED ROBIN',
        desc: 'Agente de campo com foco em investiga√ß√£o e estrat√©gia (N√≠vel 3). Acesso a √°reas de risco e invent√°rio.',
        security: ['ID T√°tico', 'Acesso Anal√≠tico'],
        responsibilities: ['Investiga√ß√£o Avan√ßada', 'Planejamento Estrat√©gico', 'An√°lise T√°tica'],
        history: 'Registros de miss√µes investigativas.',
        photo: 'timdrake.jpg',
        function: 'Investiga√ß√£o e estrat√©gia',
        specialty: 'Detetive, an√°lise t√°tica, tecnologia',
        weakness: 'Perfeccionismo',
        relationships: 'Bruce (mentor), Damian (rival amig√°vel)',
        observations: 'WAYNE-OS v3.8 integrado'
      },
      jason: {
        id: 'jason', name: 'Jason Todd', role: 'Ex-Field Agent / Red Hood', pass: 'redhood', theme: '#B71C1C', level: 3, short:'RH', codiname: 'RED HOOD',
        desc: 'Agente arquivado (N√≠vel 3). Status: Desativado. Perfil agressivo com alto risco.',
        security: ['ID Arquivado', 'Protocolo de Risco'],
        responsibilities: ['Opera√ß√µes Independentes (Arquivado)', 'Combate Urbano'],
        history: 'Ex-Robin, retorno problem√°tico.',
        photo: 'jason.jpg',
        function: 'Opera√ß√µes de alto risco (arquivado)',
        specialty: 'Combate letal, armas de fogo',
        weakness: 'Trauma de morte, raiva',
        relationships: 'Bruce (conflituoso), Fam√≠lia Wayne (tenso)',
        observations: 'GCPD monitorando, Arkham logs'
      }
    };
    
    const USERS = Object.values(USER_PROFILES);

    const INVENTORY_DATA = [
      { code: 'V-001', item: 'Batm√≥vel (Tumbler)', category: 'Ve√≠culo', local: 'Garagem A', quantity: 1, status: 'normal', lastMove: '1 min atr√°s', resp: 'B. Wayne', icon: 'shield', tooltip: 'Pronto para patrulha', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'V-002', item: 'Batpod', category: 'Ve√≠culo', local: 'Oficina 3', quantity: 1, status: 'attention', lastMove: '10 min atr√°s', resp: 'L. Fox', icon: 'chip', tooltip: 'Em manuten√ß√£o', priority: 'Alto', sensitive: false },
      { code: 'V-003', item: 'Batwing MK-II', category: 'Ve√≠culo', local: 'Hangar Norte', quantity: 1, status: 'reserved', lastMove: 'Agora', resp: 'B. Wayne', icon: 'shield', tooltip: 'Reservado para miss√£o', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'G-104', item: 'Lan√ßador de Arp√©u', category: 'Gadget', local: 'Cinto T√°tico', quantity: 5, status: 'normal', lastMove: '5h atr√°s', resp: 'D. Grayson', icon: 'chip', tooltip: 'Estoque normal', priority: 'Normal', sensitive: false },
      { code: 'G-105', item: 'Batarangs Explosivos', category: 'Gadget', local: 'Arsenal Sub', quantity: 2, status: 'critical', lastMove: '30 min atr√°s', resp: 'Alfred P.', icon: 'frasco', tooltip: 'Menos de 5 unidades restantes', priority: 'Alto', sensitive: true },
      { code: 'T-800', item: 'Exo-Suit V8', category: 'Traje', local: 'Lab R&D', quantity: 1, status: 'critical', lastMove: '1 dia atr√°s', resp: 'L. Fox', icon: 'shield', tooltip: 'Danificado', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'G-106', item: 'Batarangs Padr√£o', category: 'Gadget', local: 'Arsenal Princ.', quantity: 50, status: 'normal', lastMove: '2 dias atr√°s', resp: 'Alfred P.', icon: 'chip', tooltip: 'Estoque normal', priority: 'Normal', sensitive: false },
      { code: 'G-107', item: 'Gel Explosivo', category: 'Gadget', local: 'Arsenal Sub', quantity: 10, status: 'attention', lastMove: '3 dias atr√°s', resp: 'B. Wayne', icon: 'frasco', tooltip: 'Verificar validade', priority: 'Alto', sensitive: true },
      { code: 'G-108', item: 'Smoke Pellets', category: 'Gadget', local: 'Cinto T√°tico', quantity: 20, status: 'normal', lastMove: '4 dias atr√°s', resp: 'D. Grayson', icon: 'chip', tooltip: 'Pronto', priority: 'Normal', sensitive: false },
      { code: 'G-109', item: 'Cryptographic Sequencer', category: 'Gadget', local: 'Lab R&D', quantity: 1, status: 'reserved', lastMove: '5 dias atr√°s', resp: 'Oracle', icon: 'chip', tooltip: 'Reservado', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'G-110', item: 'Bat-Signal Projector', category: 'Gadget', local: 'Torre Wayne', quantity: 1, status: 'normal', lastMove: '6 dias atr√°s', resp: 'Alfred P.', icon: 'shield', tooltip: 'Operacional', priority: 'Alto', sensitive: false },
      { code: 'G-111', item: 'EMP Device', category: 'Gadget', local: 'Arsenal Princ.', quantity: 3, status: 'normal', lastMove: '5h atr√°s', resp: 'D. Wayne', icon: 'shield', tooltip: 'Estoque normal', priority: 'Alto', sensitive: false },
      { code: 'G-112', item: 'Batclaw', category: 'Gadget', local: 'Arsenal Princ.', quantity: 4, status: 'normal', lastMove: '6h atr√°s', resp: 'B. Wayne', icon: 'chip', tooltip: 'Pronto', priority: 'Normal', sensitive: true },
      { code: 'G-113', item: 'Remote Hacking Device', category: 'Gadget', local: 'Lab R&D', quantity: 1, status: 'attention', lastMove: '7h atr√°s', resp: 'Oracle', icon: 'chip', tooltip: 'Em manuten√ß√£o', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'G-114', item: 'Freeze Blast', category: 'Gadget', local: 'Arsenal Sub', quantity: 2, status: 'reserved', lastMove: '8h atr√°s', resp: 'L. Fox', icon: 'frasco', tooltip: 'Reservado', priority: 'Alto', sensitive: false },
      { code: 'G-115', item: 'Disruptor', category: 'Gadget', local: 'Cinto T√°tico', quantity: 3, status: 'critical', lastMove: '9h atr√°s', resp: 'Alfred P.', icon: 'shield', tooltip: 'Danificado', priority: 'Alto', sensitive: true },
      { code: 'G-116', item: 'Serum Anti-Venom', category: 'Gadget', local: 'Lab R&D', quantity: 1, status: 'reserved', lastMove: '12h atr√°s', resp: 'L. Fox', icon: 'frasco', tooltip: 'Reservado para emerg√™ncias (ref. Venom)', priority: 'Cr√≠tico', sensitive: true },
      { code: 'T-801', item: 'Capa de Kevlar MK-III', category: 'Traje', local: 'Arsenal Sub', quantity: 2, status: 'normal', lastMove: '1 dia atr√°s', resp: 'Alfred P.', icon: 'shield', tooltip: 'Atualizado p√≥s-Knightfall', priority: 'Alto', sensitive: true },
      { code: 'G-117', item: 'Dispositivo de Escuta Owl', category: 'Gadget', local: 'Cinto T√°tico', quantity: 3, status: 'attention', lastMove: '2 dias atr√°s', resp: 'Oracle', icon: 'chip', tooltip: 'Monitorando sombras ocultas', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'G-118', item: 'G√°s do Riso Ant√≠doto', category: 'Gadget', local: 'Arsenal Sub', quantity: 5, status: 'reserved', lastMove: '3 dias atr√°s', resp: 'B. Wayne', icon: 'frasco', tooltip: 'Reservado para incidentes com palha√ßos (ref. Joker)', priority: 'Cr√≠tico', sensitive: true },
      { code: 'G-119', item: 'Veneno do Espantalho', category: 'Gadget', local: 'Lab R&D', quantity: 1, status: 'critical', lastMove: '4 dias atr√°s', resp: 'L. Fox', icon: 'frasco', tooltip: 'Em an√°lise para ant√≠doto (ref. Scarecrow)', priority: 'Alto', sensitive: true },
      { code: 'G-120', item: 'Moeda de Duas Faces', category: 'Gadget', local: 'Arquivo Confidencial', quantity: 1, status: 'reserved', lastMove: '5 dias atr√°s', resp: 'Oracle', icon: 'chip', tooltip: 'Reservado para estudo psicol√≥gico (ref. Two-Face)', priority: 'Normal', sensitive: false },
      { code: 'G-121', item: 'Guarda-Chuva Armado', category: 'Gadget', local: 'Arsenal Princ.', quantity: 2, status: 'normal', lastMove: '6 dias atr√°s', resp: 'Alfred P.', icon: 'shield', tooltip: 'Capturado de ave √°rtica (ref. Penguin)', priority: 'Alto', sensitive: true },
      { code: 'G-122', item: 'Veneno da Hera', category: 'Gadget', local: 'Lab R&D', quantity: 3, status: 'attention', lastMove: '7 dias atr√°s', resp: 'L. Fox', icon: 'frasco', tooltip: 'Em quarentena bot√¢nica (ref. Poison Ivy)', priority: 'Cr√≠tico', sensitive: true },
      { code: 'G-123', item: 'Martelo da Harley', category: 'Gadget', local: 'Arsenal Sub', quantity: 1, status: 'reserved', lastMove: '8 dias atr√°s', resp: 'B. Wayne', icon: 'shield', tooltip: 'Confiscado de palha√ßa louca (ref. Harley Quinn)', priority: 'Alto', sensitive: true },
      { code: 'G-124', item: 'G√°s Congelante', category: 'Gadget', local: 'Lab R&D', quantity: 4, status: 'normal', lastMove: '9 dias atr√°s', resp: 'Oracle', icon: 'frasco', tooltip: 'Reservado para inverno rigoroso (ref. Mr. Freeze)', priority: 'Normal', sensitive: false },
      { code: 'G-125', item: 'Forma de Barro', category: 'Gadget', local: 'Arquivo Confidencial', quantity: 1, status: 'critical', lastMove: '10 dias atr√°s', resp: 'Alfred P.', icon: 'chip', tooltip: 'Em conten√ß√£o mut√°vel (ref. Clayface)', priority: 'Cr√≠tico', sensitive: true },
      { code: 'G-126', item: 'Experimento Homem-Morcego', category: 'Gadget', local: 'Lab R&D', quantity: 2, status: 'reserved', lastMove: '11 dias atr√°s', resp: 'L. Fox', icon: 'frasco', tooltip: 'Reservado para estudo sonoro (ref. Man-Bat)', priority: 'Alto', sensitive: true },
      { code: 'G-127', item: 'Chap√©u do Chapeleiro', category: 'Gadget', local: 'Arsenal Princ.', quantity: 1, status: 'attention', lastMove: '12 dias atr√°s', resp: 'B. Wayne', icon: 'shield', tooltip: 'Controle mental em an√°lise (ref. Mad Hatter)', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'G-128', item: 'M√°scara Negra', category: 'Gadget', local: 'Arquivo Confidencial', quantity: 1, status: 'normal', lastMove: '13 dias atr√°s', resp: 'Oracle', icon: 'chip', tooltip: 'Reservado para m√°fia (ref. Black Mask)', priority: 'Alto', sensitive: false },
      { code: 'G-129', item: 'L√¢mina do Assassino', category: 'Gadget', local: 'Arsenal Sub', quantity: 3, status: 'reserved', lastMove: '14 dias atr√°s', resp: 'D. Grayson', icon: 'shield', tooltip: 'Liga das Sombras (ref. Ra\'s al Ghul)', priority: 'Cr√≠tico', sensitive: true },
      { code: 'G-130', item: 'Enigma Decodificador', category: 'Gadget', local: 'Lab R&D', quantity: 5, status: 'normal', lastMove: '15 dias atr√°s', resp: 'Tim Drake', icon: 'chip', tooltip: 'Para puzzles mentais (ref. Riddler)', priority: 'Normal', sensitive: true },
      { code: 'G-131', item: 'Serum Titan', category: 'Gadget', local: 'Lab R&D', quantity: 1, status: 'critical', lastMove: '16 dias atr√°s', resp: 'L. Fox', icon: 'frasco', tooltip: 'Em conten√ß√£o qu√≠mica (ref. Bane)', priority: 'Alto', sensitive: true },
      { code: 'G-132', item: 'Gato de Nove Caudas', category: 'Gadget', local: 'Arsenal Princ.', quantity: 2, status: 'reserved', lastMove: '17 dias atr√°s', resp: 'Barbara Gordon', icon: 'shield', tooltip: 'Confiscado de felina (ref. Catwoman)', priority: 'N√≠vel Batman', sensitive: true },
      { code: 'G-133', item: 'Espada do Filho', category: 'Gadget', local: 'Arquivo Confidencial', quantity: 1, status: 'attention', lastMove: '18 dias atr√°s', resp: 'Damian Wayne', icon: 'shield', tooltip: 'Heran√ßa assassina (ref. Damian Wayne/Robin)', priority: 'Cr√≠tico', sensitive: true },
      { code: 'G-134', item: 'Bast√£o Escrima', category: 'Gadget', local: 'Arsenal Sub', quantity: 4, status: 'normal', lastMove: '19 dias atr√°s', resp: 'Dick Grayson', icon: 'chip', tooltip: 'Para acrobacias noturnas (ref. Nightwing)', priority: 'Alto', sensitive: false }
    ];

    const AREA_DATA = [
      { id: 'area-1', name: 'Batcaverna - Central', level: 5, status: 'ok', risk: 'Baixo', icon: 'M12 2L2 7l10 5 10-5-10-5zm0 9l2-1-7.97 4.14L12 11zm0 0l-2-1 7.97 4.14L12 11z', tags: ['Biometria', 'C√¢meras IR', 'Restrito'], lastEvent: 'Sem eventos h√° 48h' },
      { id: 'area-2', name: 'Laborat√≥rio P&D', level: 4, status: 'warn', risk: 'M√©dio', icon: 'M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z', tags: ['Prot√≥tipos', 'Quimica', 'Manuten√ß√£o'], lastEvent: 'Manuten√ß√£o agendada (L. Fox)' },
      { id: 'area-3', name: 'Arsenal Subterr√¢neo', level: 5, status: 'ok', risk: 'Alto', icon: 'M6 9H4.5a2.5 2.5 0 0 1 0-5H6', tags: ['Armaria', 'Explosivos', 'Restrito'], lastEvent: 'Invent√°rio validado (Alfred P.)' },
      { id: 'area-4', name: 'Centro de Comunica√ß√µes', level: 3, status: 'ok', risk: 'Baixo', icon: 'M12 2a10 10 0 0 1 10 10c0 5.52-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16z', tags: ['Sat√©lite', 'Escuta', 'Ativo'], lastEvent: 'Tr√°fego intenso detectado' },
      { id: 'area-5', name: 'Cobertura Wayne Tower', level: 3, status: 'warn', risk: 'M√©dio', icon: 'M3 21h18M5 21V7l8-4 8 4v14', tags: ['Heliponto', 'Entrada A√©rea', 'Manuten√ß√£o'], lastEvent: 'Manuten√ß√£o de luzes (Sistema)' },
      { id: 'area-6', name: 'Arquivo Confidencial', level: 5, status: 'ok', risk: 'Extremo', icon: 'M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z', tags: ['Dossi√™s', 'Identidades', 'Restrito'], lastEvent: 'Acesso: Bruce Wayne (1h atr√°s)' },
      { id: 'area-7', name: 'Subsolo Gotham Docks', level: 2, status: 'crit', risk: 'Cr√≠tico', icon: 'M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z', tags: ['Per√≠metro', 'Sensores', 'Offline'], lastEvent: 'SENSOR OFFLINE (Setor 4) - CR√çTICO' },
      { id: 'area-8', name: 'Alfred Operations Hub', level: 4, status: 'ok', risk: 'Baixo', icon: 'M20 7h-9', tags: ['Controle Remoto', 'Suporte', 'Ativo'], lastEvent: 'Ativo - Monitorando (Alfred P.)' }
    ];

    const ALERTS_DATA = [
      { time: '20:15', category: 'Seguran√ßa', desc: 'Intrus√£o detectada em Docks', level: 'Cr√≠tico' },
      { time: '19:40', category: 'Energia', desc: 'Flutua√ß√£o no Reator Ark', level: 'Aten√ß√£o' },
      { time: '18:30', category: 'Rede', desc: 'Acesso concedido a Oracle', level: 'Normal' },
      { time: '17:45', category: 'Invent√°rio', desc: 'Item cr√≠tico baixo', level: 'Cr√≠tico' },
      { time: '16:20', category: 'Miss√µes', desc: 'Atualiza√ß√£o de status', level: 'Info' },
      { time: '15:10', category: 'Seguran√ßa', desc: 'Per√≠metro seguro', level: 'Info' },
      { time: '14:05', category: 'Energia', desc: 'Backup ativado', level: 'Aten√ß√£o' }
    ];

    const MISSIONS_DATA = [
      { name: 'Patrulha Gotham Central', resp: 'Batman', loc: 'Centro', status: 'Em progresso', priority: 'Alta', progress: 60 },
      { name: 'Infiltra√ß√£o Arkham', resp: 'Nightwing', loc: 'Arkham', status: 'Planejamento', priority: 'Cr√≠tica', progress: 20 },
      { name: 'Vigil√¢ncia Docks', resp: 'Robin', loc: 'Docks', status: 'Completa', priority: 'M√©dia', progress: 100 }
    ];

    const LOGS_DATA = [
      '[20:15:22] - Alerta: Intrus√£o em Docks',
      '[19:40:01] - Sistema: Temperatura normal',
      '[18:30:10] - Acesso: Alfred logado',
      '[17:01:00] - Aviso: Baixa bateria drone',
      '[16:45:12] - Acesso Negado: Tentativa detectada',
      '[15:10:05] - Reinicializa√ß√£o: Energia',
      '[14:22:45] - Protocolo Knightfall: Monitorando integridade estrutural',
      '[09:18:30] - Acesso a Arquivo Hush: Negado (N√≠vel insuficiente)',
      '[22:05:12] - Detec√ß√£o de Owls no per√≠metro: Falso positivo',
      '[03:47:00] - Link com GCPD: Sinal de morcego ativado',
      '[21:30:55] - Anomalia detectada: Risada ecoando em Arkham (ref. Joker)',
      '[18:45:20] - Toxina do medo identificada: Ant√≠doto aplicado (ref. Scarecrow)',
      '[16:20:10] - Moeda lan√ßada: Decis√£o aleat√≥ria registrada (ref. Two-Face)',
      '[14:55:40] - Guarda-chuva armado confiscado: An√°lise em progresso (ref. Penguin)',
      '[12:10:25] - Veneno bot√¢nico neutralizado: Quarentena ativa (ref. Poison Ivy)',
      '[10:35:50] - Martelo gigante detectado: Item louco capturado (ref. Harley Quinn)',
      '[08:50:15] - Arma de congelamento falhou: Reparos urgentes (ref. Mr. Freeze)',
      '[07:15:40] - Forma mut√°vel contida: Barro em an√°lise (ref. Clayface)',
      '[05:40:05] - Eco sonoro anormal: Homem-morcego avistado (ref. Man-Bat)',
      '[04:05:30] - Controle mental bloqueado: Chap√©u destru√≠do (ref. Mad Hatter)',
      '[02:30:55] - M√°scara negra removida: M√°fia sob vigil√¢ncia (ref. Black Mask)',
      '[01:00:20] - L√¢mina assassina interceptada: Liga das Sombras (ref. Ra\'s al Ghul)',
      '[23:25:45] - Enigma resolvido: Puzzle mental desarmado (ref. Riddler)',
      '[22:00:10] - For√ßa tit√¢nica contida: Serum em quarentena (ref. Bane)',
      '[20:35:35] - Chicote felino capturado: Gata na jaula (ref. Catwoman)',
      '[19:10:00] - Espada do herdeiro: Treinamento conclu√≠do (ref. Damian/Robin)',
      '[17:45:25] - Bast√£o escrima calibrado: Acrobacias noturnas (ref. Nightwing)',
      '[16:20:50] - Link com Torre da Liga: Justi√ßa convocada (ref. Justice League)',
      '[14:55:15] - Kryptonita detectada: Aliado de a√ßo alertado (ref. Superman)',
      '[13:30:40] - Anel verde em scan: Lanterna em patrulha (ref. Green Lantern)',
      '[12:05:05] - Tridente aqu√°tico: Rei dos mares contatado (ref. Aquaman)',
      '[10:40:30] - Velocidade for√ßada: Flash em movimento (ref. Flash)',
      '[09:15:55] - La√ßo da verdade: Amazona aliada (ref. Wonder Woman)'
    ];

    let currentUser = null;
    let currentFilter = 'Todos';
    let logInterval;
    let logPaused = false;
    let alertFilter = 'Todos';

    function setGridColor(hexColor) {
        const hex = hexColor.replace('#', '');
        const r = parseInt(hex.substring(0, 2), 16);
        const g = parseInt(hex.substring(2, 4), 16);
        const b = parseInt(hex.substring(4, 6), 16);
        document.documentElement.style.setProperty('--grid-color', `rgba(${r}, ${g}, ${b}, 0.1)`);
    }
    
    function updateAccentColor(hexColor) {
        document.documentElement.style.setProperty('--accent', hexColor);
        setGridColor(hexColor);
        const logo = document.querySelector('.brand-logo');
        if (logo) logo.style.background = hexColor;
    }

    function handleLogin(e) {
      e.preventDefault();
      const u = document.getElementById('username').value.toLowerCase();
      const p = document.getElementById('password').value;
      
      const user = USERS.find(user => user.id === u && user.pass === p);
      
      if(user) {
        currentUser = user;
        updateAccentColor(user.theme);
        launchApp();
      } else {
        document.getElementById('loginError').textContent = 'ACESSO NEGADO: Credenciais Inv√°lidas.';
        document.getElementById('password').value = '';
      }
    }

    function launchApp() {
      const login = document.getElementById('loginScreen');
      login.style.opacity = '0';
      setTimeout(() => {
        login.style.display = 'none';
        document.getElementById('app').style.display = 'grid';
        
        document.getElementById('userName').innerText = currentUser.name;
        document.getElementById('userLevel').innerText = `N√çVEL ${currentUser.level}`;
        const avatarBox = document.getElementById('userAvatar');
        const avatarImg = document.getElementById('userAvatarImg');

        // escolhe caminho relativo robusto
        // tente primeiro com ./img/ (mais comum). Se seu html estiver em subpasta ajuste para ../img/
        const chosenPath = `./img/${currentUser.photo}`; 

        console.log('[Avatar] tentando carregar:', chosenPath);
        avatarImg.src = chosenPath;

        // se carregar com sucesso, remove background/placeholder e garante visibilidade
        avatarImg.onload = () => {
          console.log('[Avatar] carregado com sucesso:', chosenPath);
          avatarImg.style.display = 'block';
          avatarBox.style.background = 'transparent'; // ou outro ajuste est√©tico
        };

        // fallback se n√£o carregar
        avatarImg.onerror = (ev) => {
          console.error('[Avatar] erro ao carregar:', chosenPath, ev);
          // remove img para n√£o deixar o elemento quebrado
          avatarImg.style.display = 'none';
          // mostra as iniciais como fallback
          avatarBox.textContent = currentUser.short || (currentUser.name && currentUser.name[0]) || 'U';
          avatarBox.style.color = currentUser.theme || 'var(--accent)';
          // opcional: tentar outro caminho alternativo (descomente se quiser tentativa autom√°tica)
          // avatarImg.src = `/img/${currentUser.photo}`;
        };

        avatarImg.src = currentUser.avatar; // imagem do usu√°rio
        avatarBox.style.borderColor = currentUser.theme;

        startClock();
        nav('dashboard');
      }, 500);
    }

    function logout() {
      currentUser = null;
      document.getElementById('app').style.display = 'none';
      const login = document.getElementById('loginScreen');
      login.style.display = 'flex';
      setTimeout(() => login.style.opacity = '1', 100);
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
      
      updateAccentColor(USER_PROFILES.bruce.theme);
    }

    function startClock() {
      setInterval(() => {
        const now = new Date();
        const datePart = now.toLocaleDateString('pt-BR');
        const timePart = now.toLocaleTimeString('pt-BR');
        document.getElementById('headerClock').innerText = `${datePart} ${timePart}`;
      }, 1000);
    }

    /* === NAVEGA√á√ÉO COM PERMISS√ÉO === */
    function nav(view) {
      document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
      document.getElementById(`nav-${view}`).classList.add('active');
      const main = document.getElementById('mainContent');
      
      const minLevel = {
        'dashboard': 1,
        'areas': 2,
        'resources': 3,
        'users': 4,
        'audit': 5
      };

      if(currentUser.level < minLevel[view]) {
        renderAccessDenied(main, minLevel[view]);
        return;
      }
      
      if(view === 'dashboard') renderDashboard(main);
      if(view === 'areas') { currentFilter = 'Todas'; renderAreasPage(main); }
      if(view === 'resources') renderResourcesPage(main);
      if(view === 'users') renderUsersPage(main);
      if(view === 'audit') renderAuditPage(main);
    }

    function renderAccessDenied(container, required) {
      container.innerHTML = `
        <div class="access-denied" style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; text-align:center; color:var(--danger); animation:fadeIn 0.5s;">
          <svg class="access-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:64px;height:64px;margin-bottom:20px;opacity:0.8; color:var(--danger);"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
          <h2 style="font-size:2rem; margin-bottom:10px; text-transform:uppercase;">ACESSO NEGADO</h2>
          <p style="color:var(--text-muted)">Protocolo de seguran√ßa ativo. Seu n√≠vel (${currentUser.level}) √© insuficiente para esta √°rea.</p>
          <p style="margin-top:10px; font-weight:700">N√çVEL REQUERIDO: ${required}</p>
        </div>
      `;
    }

    /* --- DASHBOARD --- */
    function renderDashboard(container) {
      container.innerHTML = `
        <h1 style="font-size:2.5rem; text-align:center; color:var(--wayne-gold); margin-bottom:10px; text-transform:uppercase;">BATCOMPUTADOR GRID | MONITORAMENTO AVAN√áADO</h1>
        <p style="font-size:1rem; text-align:center; color:var(--text-muted); margin-bottom:20px;">Painel t√°tico de ativos e incidentes em Gotham</p>
        <div class="dashboard-layout">
          <div class="dashboard-top-left metric-card">
            <h3>Status do Sistema</h3>
            <div class="system-bar">
              <span class="system-indicator safe"><svg class="icon-sm" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg> Seguran√ßa: OK</span>
              <span class="system-indicator nominal"><svg class="icon-sm" viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path></svg> Energia: Nominal</span>
              <span class="system-indicator alert"><svg class="icon-sm" viewBox="0 0 24 24"><path d="M12 2a10 10 0 0 1 10 10c0 5.52-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16z"></path></svg> Rede: Aten√ß√£o</span>
              <span class="system-indicator safe"><svg class="icon-sm" viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect></svg> Invent√°rio: OK</span>
              <span class="system-indicator critical"><svg class="icon-sm" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg> Miss√µes: Cr√≠tico</span>
            </div>
          </div>
          <div class="dashboard-top-right metric-card">
            <h3>Resumo de Invent√°rio</h3>
            <div class="summary-count">135 Itens</div>
            <div>Cr√≠ticos: 7</div>
            <div class="bar-chart">
              <div class="bar" style="height: 40%;"></div>
              <div class="bar" style="height: 70%;"></div>
              <div class="bar" style="height: 30%;"></div>
            </div>
          </div>
          <div class="dashboard-middle-left metric-card alerts-panel" id="alertsPanel">
            <h3>Alertas Recentes</h3>
            <div class="alert-filters">
              <button class="filter-chip active" onclick="setAlertFilter('Todos')">Todos</button>
              <button class="filter-chip" onclick="setAlertFilter('Cr√≠tico')">Cr√≠tico</button>
              <button class="filter-chip" onclick="setAlertFilter('Aten√ß√£o')">Aten√ß√£o</button>
              <button class="filter-chip" onclick="setAlertFilter('Info')">Info</button>
              <button class="action-btn" onclick="showAllAlerts()">Ver todos</button>
            </div>
            ${renderAlerts()}
          </div>
            <div class="dashboard-middle-right metric-card">
              <h3>Mapa Central</h3>
              <div class="mini-map">
                <div class="map-point" style="top:20%; left:30%;" data-tooltip="Laborat√≥rio: Seguro, 2 itens cr√≠ticos"><div class="map-mini-card"><svg class="icon" viewBox="0 0 24 24"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg> Seguro | Alertas: 0 | Cr√≠ticos: 2</div></div>
                <div class="map-point" style="top:50%; left:50%;" data-tooltip="Arsenal: Aten√ß√£o, Sensores offline"><div class="map-mini-card"><svg class="icon" viewBox="0 0 24 24"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path></svg> Aten√ß√£o | Alertas: 1 | Cr√≠ticos: 3</div></div>
                <div class="map-point" style="top:70%; left:70%;" data-tooltip="Hangar: OK, Batwing pronto"><div class="map-mini-card"><svg class="icon" viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path></svg> OK | Alertas: 0 | Cr√≠ticos: 0</div></div>
                <div class="map-point" style="top:40%; left:80%;" data-tooltip="Escrit√≥rios: Nominal"><div class="map-mini-card"><svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg> Nominal | Alertas: 0 | Cr√≠ticos: 1</div></div>
              </div>
          </div>
          <div class="dashboard-bottom-left metric-card missions-panel">
            <h3>Miss√µes Ativas</h3>
            ${MISSIONS_DATA.map((mission, index) => `
              <div class="mission-card">
                <h4>${mission.name}</h4>
                <p>Resp: ${mission.resp}</p>
                <p>Loc: ${mission.loc}</p>
                <p>Status: ${mission.status}</p>
                <p>Prioridade: ${mission.priority}</p>
                <div class="progress-bar"><div class="progress-fill" style="width: ${mission.progress}%;"></div></div>
                <button class="details-btn" onclick="showMissionDetails(${index})">Detalhes</button>
              </div>
            `).join('')}
          </div>
          <div class="dashboard-bottom-right metric-card logs-panel" id="logsPanel">
            <h3>Log em Tempo Real</h3>
            <div class="log-controls">
              <button class="action-btn" id="pauseLogBtn" onclick="toggleLogScroll()">Pausar Feed</button>
            </div>
            ${LOGS_DATA.map(log => `<div class="log-item">${log}</div>`).join('')}
          </div>
        </div>
      `;
      startLogScroll();
      applyAlertFilter('Todos');
    }

    function renderAlerts() {
      return ALERTS_DATA.slice(0, 5).map(alert => `<div class="alert-item" data-level="${alert.level}">${alert.time} - ${alert.category}: ${alert.desc} (${alert.level})</div>`).join('');
    }

    function setAlertFilter(filter) {
      alertFilter = filter;
      document.querySelectorAll('.alert-filters .filter-chip').forEach(btn => btn.classList.remove('active'));
      const activeBtn = document.querySelector(`.alert-filters .filter-chip[onclick="setAlertFilter('${filter}')"]`);
      if (activeBtn) activeBtn.classList.add('active');
      applyAlertFilter(filter);
    }

    function applyAlertFilter(filter) {
      const items = document.querySelectorAll('.alert-item');
      items.forEach(item => {
        const level = item.dataset.level;
        item.classList.toggle('filtered-out', filter !== 'Todos' && level !== filter);
      });
    }

    function showAllAlerts() {
      showModal('Todos os Alertas', ALERTS_DATA.map(alert => `<div>${alert.time} - ${alert.category}: ${alert.desc} (${alert.level})</div>`).join(''));
    }

    function showMissionDetails(index) {
      const mission = MISSIONS_DATA[index];
      showModal(mission.name, `
        <p>Respons√°vel: ${mission.resp}</p>
        <p>Localiza√ß√£o: ${mission.loc}</p>
        <p>Status: ${mission.status}</p>
        <p>Prioridade: ${mission.priority}</p>
        <p>Progresso: ${mission.progress}%</p>
        <p>Detalhes adicionais: Miss√£o em andamento com suporte remoto de Oracle.</p>
      `);
    }

    function activateContainment() {
      alert('Modo de Conten√ß√£o ativado. Todas as √°reas bloqueadas.');
    }

    function lockFacilities() {
      alert('Instala√ß√µes bloqueadas. Acesso restrito ativado.');
    }

    function startLogScroll() {
      const logs = document.getElementById('logsPanel');
      logInterval = setInterval(() => {
        if (!logPaused) {
          const newLog = LOGS_DATA[Math.floor(Math.random() * LOGS_DATA.length)];
          logs.innerHTML += `<div class="log-item">${newLog}</div>`;
          logs.scrollTop = logs.scrollHeight;
        }
      }, 5000);
    }

    function toggleLogScroll() {
      logPaused = !logPaused;
      document.getElementById('pauseLogBtn').innerText = logPaused ? 'Retomar Feed' : 'Pausar Feed';
    }

    /* --- √ÅREAS --- */
    function renderAreasPage(container) {
      const criticalCount = AREA_DATA.filter(a => a.status === 'crit').length;
      const maintenanceCount = AREA_DATA.filter(a => a.status === 'warn').length;
      const highSecCount = AREA_DATA.filter(a => a.level >= 5).length;

      container.innerHTML = `
        <div class="page-header">
          <div class="page-title"><h2>Monitoramento <span>√Åreas Cr√≠ticas</span></h2></div>
        </div>
        
        <div class="area-filters">
          ${renderFilterChip('Todas', AREA_DATA.length)}
          ${renderFilterChip('Cr√≠ticas', criticalCount)}
          ${renderFilterChip('Em Manuten√ß√£o', maintenanceCount)}
          ${renderFilterChip('Alta Seguran√ßa', highSecCount)}
        </div>

        <div class="areas-container" id="areasGrid">
           ${AREA_DATA.map(a => renderAreaCardHTML(a)).join('')}
        </div>
      `;
      applyFilter(currentFilter);
    }
    
    function renderFilterChip(label, count) {
        const isActive = label === currentFilter ? 'active' : '';
        return `<button class="filter-chip ${isActive}" onclick="setFilter('${label}')">${label} (${count})</button>`;
    }

    function setFilter(filter) {
        currentFilter = filter;
        document.querySelectorAll('.filter-chip').forEach(btn => btn.classList.remove('active'));
        document.querySelector(`.filter-chip[onclick="setFilter('${filter}')"]`).classList.add('active');
        applyFilter(filter);
    }
    
    function applyFilter(filter) {
        const areas = document.getElementById('areasGrid').children;
        
        Array.from(areas).forEach(card => {
            const areaId = card.getAttribute('data-id');
            const area = AREA_DATA.find(a => a.id === areaId);
            let shouldShow = false;

            if (filter === 'Todas') shouldShow = true;
            else if (filter === 'Cr√≠ticas') shouldShow = area.status === 'crit';
            else if (filter === 'Em Manuten√ß√£o') shouldShow = area.status === 'warn';
            else if (filter === 'Alta Seguran√ßa') shouldShow = area.level >= 5;

            card.classList.toggle('filtered-out', !shouldShow);
        });
    }

    function renderAreaCardHTML(area) {
       const statusClass = area.status === 'ok' ? 'ok' : area.status === 'warn' ? 'warn' : 'crit';
       const statusText = area.status === 'ok' ? 'SEGURO' : area.status === 'warn' ? 'MANUTEN√á√ÉO' : 'CR√çTICO';
       
       let bars = '';
       for(let i=1; i<=5; i++) { bars += `<div class="lvl-seg ${i <= area.level ? 'filled' : ''}"></div>`; }

       const riskClass = area.risk === 'Baixo' ? 'risk-low' : area.risk === 'M√©dio' ? 'risk-medium' : area.risk === 'Alto' ? 'risk-high' : 'risk-extreme';

       return `
        <div class="area-card" data-id="${area.id}">
          <div class="area-header-card">
            <div class="area-title-card">
              <svg class="icon" viewBox="0 0 24 24"><path d="${area.icon}"></path></svg>
              ${area.name}
            </div>
          </div>
          <div class="area-body-card">
            <div class="level-indicator">
              <div class="level-label"><span>SEGURAN√áA</span> <span>N√çVEL ${area.level}</span></div>
              <div class="level-bar">${bars}</div>
            </div>
            
            <div class="risk-label ${riskClass}">
                <svg class="icon-sm" viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                RISCO: ${area.risk}
            </div>

            <div style="font-size:0.75rem; color:var(--text-dim); margin:10px 0 8px 0;">√öltimo Evento: ${area.lastEvent}</div>
            <div class="area-tags">
              ${area.tags.map(t => `<span class="tag">${t}</span>`).join('')}
            </div>
          </div>
          <div class="area-footer-card">
            <span class="status-badge ${statusClass}">${statusText}</span>
            <button class="details-btn" onclick="showAreaDetails('${area.id}')">VER DETALHES <svg class="icon-sm" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"></polyline></svg></button>
          </div>
        </div>
       `;
    }

    function showAreaDetails(areaId) {
        const area = AREA_DATA.find(a => a.id === areaId);
        const statusClass = area.status === 'ok' ? 'status-badge ok' : area.status === 'warn' ? 'status-badge warn' : 'status-badge crit';
        const statusText = area.status === 'ok' ? 'NOMINAL' : area.status === 'warn' ? 'ANORMAL' : 'FALHA CR√çTICA';
        const riskClass = area.risk === 'Baixo' ? 'risk-low' : area.risk === 'M√©dio' ? 'risk-medium' : area.risk === 'Alto' ? 'risk-high' : 'risk-extreme';

        showModal(area.name, `
            <p style="font-size:0.85rem; color:var(--text-muted); margin-bottom:25px;">Painel de controle e diagn√≥stico em tempo real.</p>
            
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <span class="${riskClass}"><svg class="icon-sm" viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg> RISCO: ${area.risk}</span>
                <span class="${statusClass}">${statusText}</span>
            </div>

            <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; font-size:0.85rem; margin-bottom:30px;">
                <div class="profile-info-card" style="border-left: 3px solid ${area.status === 'ok' ? 'var(--success)' : 'var(--danger)'}">
                    <h4 style="color:var(--text-main); margin-bottom:10px;">CONFIGURA√á√ÉO DE ACESSO</h4>
                    <div class="profile-detail-list">
                        <div><strong>N√≠vel M√≠nimo:</strong> N√≠vel ${area.level}</div>
                        <div><strong>M√©todo:</strong> Biometria, Senha T√°tica</div>
                        <div><strong>Tags:</strong> ${area.tags.join(', ')}</div>
                    </div>
                </div>
                <div class="profile-info-card" style="border-left: 3px solid var(--info)">
                    <h4 style="color:var(--text-main); margin-bottom:10px;">DIAGN√ìSTICO DO SISTEMA</h4>
                    <div class="profile-detail-list">
                        <div><strong>Sensores:</strong> ${area.status === 'crit' ? '50% OFFLINE' : 'Todos ONLINE'}</div>
                        <div><strong>C√¢meras:</strong> 12 UNIDADES ATIVAS</div>
                        <div><strong>√öltima Manuten√ß√£o:</strong> 25/11/2025</div>
                    </div>
                </div>
            </div>
            
            <h4 style="color:var(--text-main); margin-bottom:15px; font-weight:600;">LOG DE EVENTOS RECENTES</h4>
            <div style="height: 150px; overflow-y: scroll; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid var(--border);">
               <p class="text-mono" style="font-size:0.75rem; color:var(--text-muted); line-height:1.4;">
                    [20:15:22] - EVENTO CR√çTICO: ${area.name} - ${area.lastEvent}<br>
                    [19:40:01] - Log de Temperatura: Normal (22.5¬∞C)<br>
                    [18:30:10] - Acesso Concedido: Alfred P. (N√≠vel 4)<br>
                    [18:28:45] - ${area.name} - Checagem de Protocolo de Seguran√ßa: OK<br>
                    [17:01:00] - Aviso: Baixa Bateria - Sensor (Setor 1)<br>
                    [16:45:12] - Acesso Negado: Usu√°rio Desconhecido (Tentativa de Brute Force)<br>
                    [15:10:05] - Reinicializa√ß√£o de Sistemas de Energia<br>
               </p>
            </div>

            <div style="margin-top:30px; text-align:right;">
                <button class="action-btn" style="margin-right:10px;" onclick="accessCameras('${area.id}')">ACESSAR C√ÇMERAS</button>
                <button class="btn-primary" onclick="closeModal()" style="width: auto; padding: 10px 20px;">FECHAR PAINEL</button>
            </div>
        `);
    }

    function accessCameras(areaId) {
      alert(`Acessando c√¢meras da √°rea ${areaId}.`);
    }

    function showModal(title, content) {
      const modal = document.getElementById('modal');
      const modalContent = document.getElementById('modalContent');
      modalContent.innerHTML = `<h2 style="color:var(--accent); margin-bottom:10px; font-weight:700; text-transform:uppercase;">${title}</h2>${content}`;
      modal.style.display = 'grid';
    }

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
    }

    /* --- INVENT√ÅRIO --- */
    function renderResourcesPage(container) {
      container.innerHTML = `
        <div class="page-header">
          <div class="page-title"><h2>Gest√£o <span>Invent√°rio</span></h2></div>
        </div>
        <div class="search-container">
          <input type="text" class="search-input" placeholder="Buscar item, c√≥digo ou setor..." oninput="filterInventory(this.value)">
          <svg class="icon search-icon" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        </div>
        <div class="inventory-filters">
          <button class="filter-chip active" onclick="setInventoryFilter('Todos')">Todos (${INVENTORY_DATA.length})</button>
          <button class="filter-chip" onclick="setInventoryFilter('Cr√≠tico')">Cr√≠tico</button>
          <button class="filter-chip" onclick="setInventoryFilter('Em rota')">Em rota</button>
          <button class="filter-chip" onclick="setInventoryFilter('Laborat√≥rio')">Laborat√≥rio</button>
          <button class="filter-chip" onclick="setInventoryFilter('Arsenal')">Arsenal</button>
        </div>
        <table class="data-table" id="inventoryTable">
          <thead>
            <tr>
              <th>C√≥digo</th>
              <th>Item</th>
              <th>Categoria</th>
              <th>Local</th>
              <th>Quantidade</th>
              <th>Status</th>
              <th>√öltima Movimenta√ß√£o</th>
              <th>Respons√°vel</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            ${renderInventoryRows()}
          </tbody>
        </table>
        <div class="inventory-grid" id="inventoryGrid">
          ${renderInventoryCards()}
        </div>
      `;
      applyInventoryFilter('Todos');
    }

    function renderInventoryRows() {
      return INVENTORY_DATA.map(item => {
        const iconPath = item.icon === 'shield' ? '<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>' :
                        item.icon === 'chip' ? '<rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line>' :
                        '<path d="M4 3h16a2 2 0 0 1 2 2v6a10 10 0 0 1-10 10A10 10 0 0 1 2 11V5a2 2 0 0 1 2-2z"></path><polyline points="8 10 12 14 16 10"></polyline>';
        const sensitiveClass = item.sensitive ? 'sensitive' : '';
        return `
          <tr class="${sensitiveClass}" data-category="${item.category}" data-local="${item.local}" data-status="${item.status}">
            <td class="text-mono">${item.code}</td>
            <td>${item.item}</td>
            <td>${item.category}</td>
            <td>${item.local}</td>
            <td class="quantity-animate">${item.quantity}</td>
            <td><span class="status-pill ${item.status}" data-tooltip="${item.tooltip}">${item.status.toUpperCase()}</span></td>
            <td>${item.lastMove}</td>
            <td>${item.resp}</td>
            <td>
              <svg class="icon" viewBox="0 0 24 24">${iconPath}</svg>
              <button class="action-btn" onclick="openDrawer('${item.code}')">Detalhes</button>
            </td>
          </tr>
        `;
      }).join('');
    }

    function renderInventoryCards() {
      return INVENTORY_DATA.map(item => {
        const sensitiveClass = item.sensitive ? 'sensitive' : '';
        return `
          <div class="inventory-card ${sensitiveClass}" data-category="${item.category}" data-local="${item.local}" data-status="${item.status}">
            <h4>${item.item}</h4>
            <svg class="icon" viewBox="0 0 24 24"></svg>
            <span class="status-pill ${item.status}" data-tooltip="${item.tooltip}">${item.status.toUpperCase()}</span>
            <div class="quantity">${item.quantity}</div>
            <span class="location">${item.local}</span>
          </div>
        `;
      }).join('');
    }

    function filterInventory(query) {
      const rows = document.querySelectorAll('#inventoryTable tbody tr');
      const cards = document.querySelectorAll('#inventoryGrid .inventory-card');
      [...rows, ...cards].forEach(el => {
        const text = el.textContent.toLowerCase();
        el.style.display = text.includes(query.toLowerCase()) ? '' : 'none';
      });
    }

    function setInventoryFilter(filter) {
      currentFilter = filter;
      document.querySelectorAll('.inventory-filters .filter-chip').forEach(btn => btn.classList.remove('active'));
      const activeBtn = document.querySelector(`.inventory-filters .filter-chip[onclick="setInventoryFilter('${filter}')"]`);
      if (activeBtn) activeBtn.classList.add('active');
      applyInventoryFilter(filter);
    }

    function applyInventoryFilter(filter) {
      const rows = document.querySelectorAll('#inventoryTable tbody tr');
      const cards = document.querySelectorAll('#inventoryGrid .inventory-card');
      [...rows, ...cards].forEach(el => {
        let show = false;
        if (filter === 'Todos') show = true;
        else if (filter === 'Cr√≠tico') show = el.dataset.status === 'critical';
        else if (filter === 'Em rota') show = el.dataset.local.includes('rota');
        else if (filter === 'Laborat√≥rio') show = el.dataset.local === 'Lab R&D';
        else if (filter === 'Arsenal') show = el.dataset.local.includes('Arsenal');
        el.style.display = show ? '' : 'none';
      });
    }

    function openDrawer(code) {
      const item = INVENTORY_DATA.find(i => i.code === code);
      const drawer = document.getElementById('itemDrawer');
      const content = document.getElementById('drawerContent');
      content.innerHTML = `
        <h3>${item.item}</h3>
        <p>Prioridade: <span class="priority">${item.priority}</span></p>
        <h4>Timeline de Movimenta√ß√µes</h4>
        <ul class="timeline">
          <li>${item.lastMove}: Movido para ${item.local}</li>
          <li>Ontem: Usado por ${item.resp}</li>
          <li>1 semana atr√°s: Reabastecido</li>
        </ul>
        <h4>Uso Recente</h4>
        <div class="sparkline"></div>
        <button class="replenish-btn" onclick="replenishStock('${code}')">Repor Estoque</button>
        <div class="replenish-msg" id="replenishMsg_${code}">Solicita√ß√£o enviada ao setor de log√≠stica ¬∑ Protocolo #WAY-2047</div>
      `;
      drawer.classList.add('open');
    }

    function closeDrawer() {
      document.getElementById('itemDrawer').classList.remove('open');
    }

    function replenishStock(code) {
      const msg = document.getElementById(`replenishMsg_${code}`);
      msg.style.display = 'block';
      setTimeout(() => msg.style.display = 'none', 5000);
    }

    /* --- PERFIS DE PESSOAL --- */
    function renderUsersPage(container) {
        container.innerHTML = `
            <div class="page-header"><div class="page-title"><h2>Gest√£o <span>Perfis de Pessoal</span></h2></div></div>
            <div class="users-panel">
                ${USERS.map(u => renderUserCard(u)).join('')}
            </div>
        `;
    }

    function renderUserCard(user) {
        return `
            <div class="user-card" style="border-left: 3px solid ${user.theme};">
                <span class="codiname">${user.codiname}</span>
                <div class="avatar" style="background-image: url('${user.photo}');"></div>
                <h3 style="font-size:1.2rem; color:var(--text-main);">${user.name}</h3>
                <p style="color:${user.theme}; font-weight:600; text-transform:uppercase; font-size:0.85rem;">${user.role}</p>
                <p>N√≠vel: ${user.level}</p>
                <p>Status: Ativo</p>
                <ul style="list-style: none; font-size:0.85rem; color:var(--text-muted); padding-left:0;">
                    ${user.responsibilities.slice(0, 3).map(r => `<li>- ${r}</li>`).join('')}
                </ul>
                <button class="details-btn" onclick="showUserDetails('${user.id}')">Ver detalhes</button>
            </div>
        `;
    }

    function showUserDetails(userId) {
      const user = USERS.find(u => u.id === userId);
      showModal(user.name, `
        <p class="desc">${user.desc}</p>
        <h5>Fun√ß√£o na Equipe:</h5>
        <p>${user.function}</p>
        <h5>Especialidade:</h5>
        <p>${user.specialty}</p>
        <h5>Ponto Fraco / Risco:</h5>
        <p>${user.weakness}</p>
        <h5>Relacionamentos Chave:</h5>
        <p>${user.relationships}</p>
        <h5>Observa√ß√µes Secretas:</h5>
        <p>${user.observations}</p>
      `);
    }

    /* --- AUDITORIA --- */
    function renderAuditPage(container) {
       container.innerHTML = `
        <div class="page-header">
          <div class="page-title"><h2>Sistema <span>Auditoria Completa (N√çVEL 5)</span></h2></div>
          <div style="display:flex; gap:10px">
            <button class="action-btn" onclick="exportCSV()">EXPORTAR CSV</button>
          </div>
         </div>
        <div class="table-wrapper">
          <table class="data-table">
            <thead><tr><th>ID Evento</th><th>Usu√°rio</th><th>A√ß√£o</th><th>Alvo</th><th>Data/Hora</th><th>Resultado</th></tr></thead>
            <tbody>
              ${generateLogs(25)}
            </tbody>
          </table>
        </div>
      `;
    }

    function exportCSV() {
      alert('Exportando CSV... (Fun√ß√£o simulada)');
    }

    function generateLogs(count) {
      const actions = ["Acesso Porta", "Login Sistema", "Consulta Dados", "Desbloqueio Remoto", "Atualiza√ß√£o Firmware"];
      const targets = ["Mainframe", "Porta Norte", "Arquivo Morto", "Cofre", "Sistema C√¢meras", "Batm√≥vel"];
      let html = '';
      const usersArray = Object.values(USER_PROFILES);
      for(let i=0; i<count; i++) {
        const user = usersArray[Math.floor(Math.random() * usersArray.length)];
        const action = actions[Math.floor(Math.random() * actions.length)];
        const target = targets[Math.floor(Math.random() * targets.length)];
        const result = Math.random() > 0.9 ? 'negado' : 'sucesso';
        const color = result === 'sucesso' ? 'var(--success)' : 'var(--danger)';
        const date = new Date(Date.now() - Math.floor(Math.random() * 100000000));
        
        html += `<tr>
          <td class="text-mono">EVT-${Math.floor(Math.random()*9000)+1000}</td>
          <td style="font-weight:600">${user.name}</td>
          <td>${action}</td>
          <td>${target}</td>
          <td class="text-mono" style="font-size:0.75rem">${date.toLocaleString('pt-BR')}</td>
          <td><span style="color:${color}; text-transform:uppercase; font-size:0.65rem; font-weight:700">${result}</span></td>
        </tr>`;
      }
      return html;
    }

    const bootLines = [
        "Inicializando Batcomputador Grid...",
        "STATUS: OK",
        "Conectando √† rede principal Gotham/Metropolis...",
        "Download de protocolos de seguran√ßa: [ OK ]",
        "Validando m√≥dulo de criptografia AES-256...",
        "Iniciando subsistema de monitoramento de amea√ßas...",
        "Batcomputer Link Status: [ ONLINE ]",
        "Carregamento completo. Aguardando credenciais...",
        "Verificando Integridade OMAC: Seguro",
        "Link com GCPD: Estabelecido (Sinal Bat)",
        "Protocolo Knightwatch: Ativo",
        "Detec√ß√£o de Owls: Monitorando elite",
        "Long Halloween: Calend√°rio de feriados carregado",
        "Death in the Family: Logs familiares arquivados",
        "Killing Joke: Humor negro detectado",
        "Under the Red Hood: Retorno monitorado",
        "Batman R.I.P.: Backup de identidade",
        "Justice League Link: Equipe mundial",
        "Trinity Protocol: Amazona, Kryptoniano, Morcego",
        "Flashpoint Check: Linha temporal est√°vel",
    ];

    function bootSequence(index = 0) {
      const output = document.getElementById('terminalOutput');
      if (index < bootLines.length) {
        const line = document.createElement('div');
        line.classList.add('terminal-line');
        output.appendChild(line);
        let charIndex = 0;
        line.classList.add('typing');
        const typeInterval = setInterval(() => {
          if (charIndex < bootLines[index].length) {
            line.textContent += bootLines[index].charAt(charIndex);
            charIndex++;
          } else {
            clearInterval(typeInterval);
            line.classList.remove('typing');
            setTimeout(() => bootSequence(index + 1), 400);
          }
        }, 30);
      } else {
        setTimeout(() => {
          const loaderScreen = document.getElementById('loader');
          const loginScreen = document.getElementById('loginScreen');
          
          loaderScreen.style.opacity = 0;
          
          setTimeout(() => {
            loaderScreen.style.display = 'none';
            updateAccentColor(USER_PROFILES.bruce.theme); 
            loginScreen.style.display = 'flex';
            setTimeout(() => loginScreen.style.opacity = 1, 100);
          }, 800);
        }, 1000);
      }
    }

    window.onload = function() {
      document.documentElement.style.setProperty('--accent', USER_PROFILES.bruce.theme);
      bootSequence();
    };

  </script>
</body>
</html>
